package com.github.gaboss44.expandlibreforge.events.entity

import com.github.gaboss44.expandlibreforge.extensions.EnchantmentEffectsInSlotData
import org.apache.commons.lang3.mutable.MutableBoolean
import org.bukkit.damage.DamageSource
import org.bukkit.entity.LivingEntity
import org.bukkit.event.HandlerList

@Suppress("UnstableApiUsage")
class EntityEnchantmentDamageInvulnerabilityEffectsEvent(
    enchantmentUser: LivingEntity,
    enchantmentEffectsData: EnchantmentEffectsInSlotData,
    val invulnerability: Boolean,
    val overrideInvulnerability: MutableBoolean,
    val originalInvulnerability: Boolean,
    val source: DamageSource
) : EntityEnchantmentEffectsInSlotEvent(
    enchantmentUser,
    enchantmentEffectsData
) {
    constructor(
        enchantmentUser: LivingEntity,
        enchantmentEffectsData: EnchantmentEffectsInSlotData,
        invulnerability: Boolean,
        originalInvulnerability: Boolean,
        source: DamageSource
    ) : this(
        enchantmentUser,
        enchantmentEffectsData,
        invulnerability,
        MutableBoolean(invulnerability),
        originalInvulnerability,
        source
    )

    constructor(
        enchantmentUser: LivingEntity,
        enchantmentEffectsData: EnchantmentEffectsInSlotData,
        overrideInvulnerability: MutableBoolean,
        originalInvulnerability: Boolean,
        source: DamageSource
    ) : this(
        enchantmentUser,
        enchantmentEffectsData,
        overrideInvulnerability.value,
        overrideInvulnerability,
        originalInvulnerability,
        source
    )

    override fun getHandlers() = handlerList

    companion object {
        private val handlerList = HandlerList()

        @JvmStatic
        fun getHandlerList(): HandlerList {
            return handlerList
        }
    }
}
